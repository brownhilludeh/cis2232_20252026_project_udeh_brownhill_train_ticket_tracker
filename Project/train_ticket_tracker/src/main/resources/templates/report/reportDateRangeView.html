<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">

<head th:replace="fragments/head :: headerFragment('Ticket Date Range Report')"></head>

<body>

    <!-- Navbar -->
    <div th:replace="fragments/navHeader :: navbar"></div>

    <!-- Main Container -->
    <div class="container my-5">

        <div class="row justify-content-center">
            <div class="col-12 col-md-10">

                <div class="card shadow-sm border-0">
                    <div class="card-body">

                        <!-- Page Title -->
                        <h2 class="text-center mb-3">Ticket Date Range Report</h2>

                        <!-- Report Summary -->
                        <p class="text-center mb-2">
                            Search results for selected issue date range â€”
                            <strong>Records Found:</strong>
                            <span th:text="${reportInput.tickets != null ? reportInput.tickets.size() : 0}">0</span>
                        </p>

                        <!-- Message if no tickets found -->
                        <p th:if="${message}" class="text-danger text-center mb-3" th:text="${message}">
                        </p>

                        <!-- Tickets Table -->
                        <div th:if="${reportInput.tickets != null and !#lists.isEmpty(reportInput.tickets)}" class="table-responsive mt-3">
                            <table class="table table-striped table-bordered table-hover align-middle mb-0" id="dataTables">
                                <thead class="table-dark text-center">
                                    <tr>
                                        <th>ID</th>
                                        <th>Passenger</th>
                                        <th>Issue Date</th>
                                        <th>From Station</th>
                                        <th>Destination</th>
                                        <th>Travel Length (km)</th>
                                        <th>Student</th>
                                        <th>Frequent</th>
                                    </tr>
                                </thead>
                                <tbody class="text-center">
                                    <tr th:each="ticket : ${reportInput.tickets}">
                                        <td th:text="${ticket.id}"></td>
                                        <td th:text="${ticket.name}"></td>
                                        <td th:text="${ticket.issueDate}"></td>
                                        <td th:text="${ticket.station}"></td>
                                        <td th:text="${ticket.destination}"></td>
                                        <td th:text="${ticket.travelLength}"></td>

                                        <!-- Student badge -->
                                        <td>
                                            <span th:if="${ticket.isStudent}" class="badge bg-success">
                                                Yes
                                            </span>
                                            <span th:unless="${ticket.isStudent}" class="badge bg-secondary">
                                                No
                                            </span>
                                        </td>

                                        <!-- Frequent badge -->
                                        <td>
                                            <span th:if="${ticket.isFrequent}" class="badge bg-info text-dark">
                                                Yes
                                            </span>
                                            <span th:unless="${ticket.isFrequent}" class="badge bg-secondary">
                                                No
                                            </span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- No data message -->
                        <div th:if="${reportInput.tickets == null or #lists.isEmpty(reportInput.tickets)}" class="mt-3 text-center">
                            <p class="text-muted mb-0">
                                No tickets found for the selected date range.
                            </p>
                        </div>

                        <!-- Back Button -->
                        <div class="text-center mt-4">
                            <a th:href="@{/report/ticket/date-range}" class="btn btn-secondary">
                                Back
                            </a>
                        </div>

                    </div>
                </div>

            </div>
        </div>

    </div>

    <!-- Footer -->
    <div th:replace="fragments/footer :: footer"></div>

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

    <!-- Bootstrap -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- DataTables -->
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>

    <!-- Custom JS (initializes #dataTables, etc.) -->
    <script th:src="@{/js/cis.js}"></script>

</body>

</html>